<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nmap Analyzer - Network Security Scanner</title>
    
    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-green: #00ff41;
            --primary-cyan: #00ffff;
            --primary-red: #ff0040;
            --primary-yellow: #ffaa00;
            --primary-purple: #b026ff;
            --dark-bg: #0a0a0f;
            --card-bg: rgba(20, 20, 30, 0.9);
            --border-color: rgba(0, 255, 65, 0.3);
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --success-color: #00ff41;
            --warning-color: #ffaa00;
            --danger-color: #ff0040;
            --info-color: #00ffff;
        }

        body {
            font-family: 'Courier New', monospace;
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(0, 255, 65, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(0, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(176, 38, 255, 0.1) 0%, transparent 50%);
        }

        /* Header */
        header {
            background: linear-gradient(180deg, rgba(10, 10, 15, 0.95), rgba(10, 10, 15, 0.8));
            backdrop-filter: blur(10px);
            border-bottom: 2px solid var(--border-color);
            padding: 20px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary-green);
            text-shadow: 0 0 20px var(--primary-green);
        }

        .logo i {
            font-size: 2rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .header-stats {
            display: flex;
            gap: 30px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            color: var(--primary-cyan);
            font-weight: bold;
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        /* Main Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        /* Scanner Section */
        .scanner-section {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
        }

        .section-title {
            font-size: 1.8rem;
            color: var(--primary-green);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .scanner-form {
            display: grid;
            grid-template-columns: 1fr auto auto;
            gap: 15px;
            margin-bottom: 20px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .input-group label {
            color: var(--primary-cyan);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .input-group input,
        .input-group select,
        .input-group textarea {
            background: rgba(0, 255, 65, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 12px;
            color: var(--text-primary);
            font-family: inherit;
            transition: all 0.3s;
        }

        .input-group input:focus,
        .input-group select:focus,
        .input-group textarea:focus {
            outline: none;
            border-color: var(--primary-green);
            box-shadow: 0 0 15px rgba(0, 255, 65, 0.3);
            background: rgba(0, 255, 65, 0.1);
        }

        .scan-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .option-card {
            background: rgba(0, 255, 65, 0.05);
            border: 1px solid rgba(0, 255, 65, 0.2);
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option-card:hover {
            background: rgba(0, 255, 65, 0.1);
            border-color: var(--primary-green);
            transform: translateY(-2px);
        }

        .option-card.selected {
            background: rgba(0, 255, 65, 0.2);
            border-color: var(--primary-green);
            box-shadow: 0 0 20px rgba(0, 255, 65, 0.3);
        }

        .option-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }

        .option-title {
            color: var(--primary-cyan);
            font-weight: bold;
        }

        .option-description {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--primary-green), var(--primary-cyan));
            color: var(--dark-bg);
        }

        .btn-secondary {
            background: transparent;
            border: 2px solid var(--primary-cyan);
            color: var(--primary-cyan);
        }

        .btn-danger {
            background: linear-gradient(45deg, var(--primary-red), var(--primary-yellow));
            color: var(--text-primary);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 255, 65, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        /* Results Section */
        .results-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .results-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .results-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border-color);
        }

        .tab {
            padding: 12px 24px;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            position: relative;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .tab:hover {
            color: var(--primary-cyan);
        }

        .tab.active {
            color: var(--primary-green);
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--primary-green);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        /* Table Styles */
        .data-table {
            width: 100%;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .data-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th {
            background: rgba(0, 255, 65, 0.1);
            padding: 15px;
            text-align: left;
            color: var(--primary-cyan);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.9rem;
            border-bottom: 2px solid var(--border-color);
        }

        .data-table td {
            padding: 12px 15px;
            border-bottom: 1px solid rgba(0, 255, 65, 0.1);
            color: var(--text-primary);
        }

        .data-table tr:hover {
            background: rgba(0, 255, 65, 0.05);
        }

        .port-status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        .port-open {
            background: rgba(0, 255, 65, 0.2);
            color: var(--success-color);
            border: 1px solid var(--success-color);
        }

        .port-closed {
            background: rgba(255, 0, 64, 0.2);
            color: var(--danger-color);
            border: 1px solid var(--danger-color);
        }

        .port-filtered {
            background: rgba(255, 170, 0, 0.2);
            color: var(--warning-color);
            border: 1px solid var(--warning-color);
        }

        /* Vulnerability Cards */
        .vulnerability-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .vuln-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s;
        }

        .vuln-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--primary-red);
        }

        .vuln-card.high::before { background: var(--danger-color); }
        .vuln-card.medium::before { background: var(--warning-color); }
        .vuln-card.low::before { background: var(--info-color); }

        .vuln-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 255, 65, 0.2);
        }

        .vuln-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .vuln-title {
            color: var(--primary-cyan);
            font-size: 1.1rem;
            font-weight: bold;
        }

        .vuln-severity {
            padding: 4px 10px;
            border-radius: 5px;
            font-size: 0.8rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        .severity-high {
            background: rgba(255, 0, 64, 0.2);
            color: var(--danger-color);
        }

        .severity-medium {
            background: rgba(255, 170, 0, 0.2);
            color: var(--warning-color);
        }

        .severity-low {
            background: rgba(0, 255, 255, 0.2);
            color: var(--info-color);
        }

        .vuln-description {
            color: var(--text-secondary);
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .vuln-cve {
            background: rgba(0, 255, 65, 0.1);
            padding: 8px 12px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 0.9rem;
            color: var(--primary-green);
        }

        /* Charts Container */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }

        .chart-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 20px;
        }

        .chart-title {
            color: var(--primary-cyan);
            font-size: 1.2rem;
            margin-bottom: 20px;
            text-align: center;
        }

        /* Network Map */
        .network-map {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 20px;
            height: 500px;
            position: relative;
            overflow: hidden;
        }

        #networkGraph {
            width: 100%;
            height: 100%;
        }

        /* Terminal Output */
        .terminal-output {
            background: #000;
            border: 1px solid var(--primary-green);
            border-radius: 10px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            max-height: 400px;
            overflow-y: auto;
            margin-top: 20px;
        }

        .terminal-line {
            margin: 5px 0;
            color: var(--primary-green);
            font-size: 0.9rem;
        }

        .terminal-command {
            color: var(--primary-cyan);
        }

        .terminal-result {
            color: var(--text-primary);
        }

        /* Loading Animation */
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(0, 255, 65, 0.3);
            border-top: 3px solid var(--primary-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            color: var(--primary-cyan);
            font-size: 1.1rem;
        }

        /* Export Options */
        .export-section {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            margin-top: 20px;
        }

        .export-btn {
            padding: 10px 20px;
            background: rgba(0, 255, 65, 0.1);
            border: 1px solid var(--primary-green);
            border-radius: 8px;
            color: var(--primary-green);
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .export-btn:hover {
            background: rgba(0, 255, 65, 0.2);
            transform: translateY(-2px);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .scanner-form {
                grid-template-columns: 1fr;
            }

            .header-stats {
                display: none;
            }

            .charts-grid {
                grid-template-columns: 1fr;
            }

            .results-tabs {
                overflow-x: auto;
            }

            .vulnerability-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--dark-bg);
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, var(--primary-green), var(--primary-cyan));
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, var(--primary-cyan), var(--primary-green));
        }

        /* Notification Toast */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--card-bg);
            border: 1px solid var(--primary-green);
            border-radius: 10px;
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            min-width: 300px;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 2000;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast-icon {
            font-size: 1.5rem;
        }

        .toast.success .toast-icon {
            color: var(--success-color);
        }

        .toast.error .toast-icon {
            color: var(--danger-color);
        }

        .toast.warning .toast-icon {
            color: var(--warning-color);
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .toast-message {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="header-content">
            <div class="logo">
                <i class="fas fa-satellite-dish"></i>
                <span>Nmap Analyzer</span>
            </div>
            <div class="header-stats">
                <div class="stat-item">
                    <div class="stat-value" id="totalHosts">0</div>
                    <div class="stat-label">Hosts Scanned</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="openPorts">0</div>
                    <div class="stat-label">Open Ports</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="vulnCount">0</div>
                    <div class="stat-label">Vulnerabilities</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="container">
        <!-- Scanner Section -->
        <section class="scanner-section">
            <h2 class="section-title">
                <i class="fas fa-radar"></i>
                Network Scanner Configuration
            </h2>

            <form id="scanForm">
                <div class="scanner-form">
                    <div class="input-group" style="grid-column: span 2;">
                        <label for="target">Target IP/Domain/Range</label>
                        <input type="text" id="target" placeholder="e.g., 192.168.1.1, example.com, 192.168.1.0/24" required>
                    </div>
                    <div class="input-group">
                        <label>&nbsp;</label>
                        <button type="button" class="btn btn-secondary" onclick="loadSampleData()">
                            <i class="fas fa-database"></i> Load Sample
                        </button>
                    </div>
                </div>

                <div class="scan-options">
                    <div class="option-card" onclick="toggleOption(this, 'syn')">
                        <div class="option-header">
                            <i class="fas fa-bolt"></i>
                            <span class="option-title">SYN Scan</span>
                        </div>
                        <div class="option-description">Fast TCP SYN port scanning</div>
                    </div>
                    <div class="option-card" onclick="toggleOption(this, 'udp')">
                        <div class="option-header">
                            <i class="fas fa-exchange-alt"></i>
                            <span class="option-title">UDP Scan</span>
                        </div>
                        <div class="option-description">UDP port scanning</div>
                    </div>
                    <div class="option-card" onclick="toggleOption(this, 'version')">
                        <div class="option-header">
                            <i class="fas fa-info-circle"></i>
                            <span class="option-title">Version Detection</span>
                        </div>
                        <div class="option-description">Service version detection</div>
                    </div>
                    <div class="option-card" onclick="toggleOption(this, 'os')">
                        <div class="option-header">
                            <i class="fas fa-desktop"></i>
                            <span class="option-title">OS Detection</span>
                        </div>
                        <div class="option-description">Operating system detection</div>
                    </div>
                    <div class="option-card" onclick="toggleOption(this, 'script')">
                        <div class="option-header">
                            <i class="fas fa-code"></i>
                            <span class="option-title">Script Scan</span>
                        </div>
                        <div class="option-description">Default NSE scripts</div>
                    </div>
                    <div class="option-card" onclick="toggleOption(this, 'aggressive')">
                        <div class="option-header">
                            <i class="fas fa-rocket"></i>
                            <span class="option-title">Aggressive</span>
                        </div>
                        <div class="option-description">Enable OS detection, version detection, script scanning, and traceroute</div>
                    </div>
                </div>

                <div class="scanner-form">
                    <div class="input-group">
                        <label for="ports">Port Specification</label>
                        <select id="ports">
                            <option value="common">Common ports (top 1000)</option>
                            <option value="all">All ports (1-65535)</option>
                            <option value="custom">Custom range</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="timing">Timing Template</label>
                        <select id="timing">
                            <option value="T3">Normal (T3)</option>
                            <option value="T2">Polite (T2)</option>
                            <option value="T4">Fast (T4)</option>
                            <option value="T5">Aggressive (T5)</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-play"></i> Start Scan
                    </button>
                </div>
            </form>

            <div class="terminal-output" id="commandPreview">
                <div class="terminal-line">
                    <span class="terminal-command">$ nmap</span>
                    <span id="nmapCommand" class="terminal-result"></span>
                </div>
            </div>
        </section>

        <!-- Loading Section -->
        <div class="loading" id="loadingSection">
            <div class="spinner"></div>
            <div class="loading-text">Scanning Network...</div>
        </div>

        <!-- Results Section -->
        <section class="results-section" id="resultsSection">
            <div class="results-tabs">
                <button class="tab active" onclick="switchTab('overview')">Overview</button>
                <button class="tab" onclick="switchTab('ports')">Ports</button>
                <button class="tab" onclick="switchTab('hosts')">Hosts</button>
                <button class="tab" onclick="switchTab('vulnerabilities')">Vulnerabilities</button>
                <button class="tab" onclick="switchTab('network')">Network Map</button>
                <button class="tab" onclick="switchTab('raw')">Raw Output</button>
            </div>

            <!-- Overview Tab -->
            <div class="tab-content active" id="overview-tab">
                <div class="charts-grid">
                    <div class="chart-card">
                        <h3 class="chart-title">Port Status Distribution</h3>
                        <canvas id="portChart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h3 class="chart-title">Service Distribution</h3>
                        <canvas id="serviceChart"></canvas>
                    </div>
                </div>

                <div class="vulnerability-grid" id="vulnerabilitySummary">
                    <!-- Vulnerability cards will be inserted here -->
                </div>
            </div>

            <!-- Ports Tab -->
            <div class="tab-content" id="ports-tab">
                <div class="data-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Port</th>
                                <th>Protocol</th>
                                <th>Status</th>
                                <th>Service</th>
                                <th>Version</th>
                                <th>Confidence</th>
                            </tr>
                        </thead>
                        <tbody id="portsTableBody">
                            <!-- Port data will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Hosts Tab -->
            <div class="tab-content" id="hosts-tab">
                <div class="data-table">
                    <table>
                        <thead>
                            <tr>
                                <th>IP Address</th>
                                <th>Hostname</th>
                                <th>OS</th>
                                <th>Uptime</th>
                                <th>Last Boot</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="hostsTableBody">
                            <!-- Host data will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Vulnerabilities Tab -->
            <div class="tab-content" id="vulnerabilities-tab">
                <div class="vulnerability-grid" id="vulnerabilitiesList">
                    <!-- Detailed vulnerability list will be inserted here -->
                </div>
            </div>

            <!-- Network Map Tab -->
            <div class="tab-content" id="network-tab">
                <div class="network-map">
                    <div id="networkGraph"></div>
                </div>
            </div>

            <!-- Raw Output Tab -->
            <div class="tab-content" id="raw-tab">
                <div class="terminal-output">
                    <div id="rawOutput">
                        <!-- Raw Nmap output will be displayed here -->
                    </div>
                </div>
            </div>

            <!-- Export Options -->
            <div class="export-section">
                <button class="export-btn" onclick="exportResults('json')">
                    <i class="fas fa-file-code"></i> Export JSON
                </button>
                <button class="export-btn" onclick="exportResults('csv')">
                    <i class="fas fa-file-csv"></i> Export CSV
                </button>
                <button class="export-btn" onclick="exportResults('xml')">
                    <i class="fas fa-file-code"></i> Export XML
                </button>
                <button class="export-btn" onclick="generateReport()">
                    <i class="fas fa-file-pdf"></i> Generate Report
                </button>
            </div>
        </section>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <div class="toast-icon">
            <i class="fas fa-check-circle"></i>
        </div>
        <div class="toast-content">
            <div class="toast-title">Success</div>
            <div class="toast-message">Operation completed successfully</div>
        </div>
    </div>

    <script>
        // Global variables
        let selectedOptions = [];
        let scanResults = null;
        let portChart = null;
        let serviceChart = null;

        // Toggle scan options
        function toggleOption(element, option) {
            element.classList.toggle('selected');
            
            if (selectedOptions.includes(option)) {
                selectedOptions = selectedOptions.filter(o => o !== option);
            } else {
                selectedOptions.push(option);
            }
            
            updateCommandPreview();
        }

        // Update Nmap command preview
        function updateCommandPreview() {
            const target = document.getElementById('target').value || '<target>';
            const ports = document.getElementById('ports').value;
            const timing = document.getElementById('timing').value;
            
            let command = ` ${target}`;
            
            // Add port specification
            if (ports === 'all') {
                command += ' -p-';
            } else if (ports === 'custom') {
                command += ' -p 1-1000';
            }
            
            // Add selected options
            selectedOptions.forEach(option => {
                switch(option) {
                    case 'syn':
                        command += ' -sS';
                        break;
                    case 'udp':
                        command += ' -sU';
                        break;
                    case 'version':
                        command += ' -sV';
                        break;
                    case 'os':
                        command += ' -O';
                        break;
                    case 'script':
                        command += ' -sC';
                        break;
                    case 'aggressive':
                        command += ' -A';
                        break;
                }
            });
            
            // Add timing
            command += ` ${timing}`;
            
            // Add output format
            command += ' -oX -';
            
            document.getElementById('nmapCommand').textContent = command;
        }

        // Event listeners for form inputs
        document.getElementById('target').addEventListener('input', updateCommandPreview);
        document.getElementById('ports').addEventListener('change', updateCommandPreview);
        document.getElementById('timing').addEventListener('change', updateCommandPreview);

        // Form submission
        document.getElementById('scanForm').addEventListener('submit', function(e) {
            e.preventDefault();
            startScan();
        });

        // Start scan simulation
        function startScan() {
            const loadingSection = document.getElementById('loadingSection');
            const resultsSection = document.getElementById('resultsSection');
            
            loadingSection.classList.add('active');
            resultsSection.classList.remove('active');
            
            // Simulate scan delay
            setTimeout(() => {
                loadingSection.classList.remove('active');
                resultsSection.classList.add('active');
                loadSampleResults();
                showToast('Scan completed successfully', 'success');
            }, 3000);
        }

        // Load sample data
        function loadSampleData() {
            document.getElementById('target').value = '192.168.1.0/24';
            updateCommandPreview();
            showToast('Sample data loaded', 'success');
        }

        // Load sample results
        function loadSampleResults() {
            // Generate sample scan results
            scanResults = {
                hosts: [
                    {
                        ip: '192.168.1.1',
                        hostname: 'router.local',
                        os: 'Linux 4.15',
                        uptime: '5 days',
                        lastBoot: '2024-01-15 10:30:00',
                        status: 'up',
                        ports: [
                            { port: 22, protocol: 'tcp', status: 'open', service: 'ssh', version: 'OpenSSH 7.4', confidence: '95%' },
                            { port: 53, protocol: 'tcp', status: 'open', service: 'domain', version: 'dnsmasq 2.76', confidence: '90%' },
                            { port: 80, protocol: 'tcp', status: 'open', service: 'http', version: 'nginx 1.14.0', confidence: '98%' },
                            { port: 443, protocol: 'tcp', status: 'open', service: 'ssl/http', version: 'nginx 1.14.0', confidence: '98%' }
                        ]
                    },
                    {
                        ip: '192.168.1.100',
                        hostname: 'server.local',
                        os: 'Windows Server 2019',
                        uptime: '12 days',
                        lastBoot: '2024-01-08 15:45:00',
                        status: 'up',
                        ports: [
                            { port: 21, protocol: 'tcp', status: 'open', service: 'ftp', version: 'Microsoft ftpd', confidence: '85%' },
                            { port: 23, protocol: 'tcp', status: 'open', service: 'telnet', version: 'Microsoft telnet', confidence: '80%' },
                            { port: 135, protocol: 'tcp', status: 'open', service: 'msrpc', version: 'Microsoft Windows RPC', confidence: '95%' },
                            { port: 445, protocol: 'tcp', status: 'open', service: 'microsoft-ds', version: 'Windows 2019', confidence: '98%' },
                            { port: 3389, protocol: 'tcp', status: 'open', service: 'rdp', version: 'Terminal Services', confidence: '90%' }
                        ]
                    },
                    {
                        ip: '192.168.1.105',
                        hostname: 'webserver.local',
                        os: 'Ubuntu 20.04',
                        uptime: '30 days',
                        lastBoot: '2023-12-20 09:00:00',
                        status: 'up',
                        ports: [
                            { port: 80, protocol: 'tcp', status: 'open', service: 'http', version: 'Apache httpd 2.4.41', confidence: '98%' },
                            { port: 443, protocol: 'tcp', status: 'open', service: 'ssl/http', version: 'Apache httpd 2.4.41', confidence: '98%' },
                            { port: 3306, protocol: 'tcp', status: 'open', service: 'mysql', version: 'MySQL 8.0.28', confidence: '95%' }
                        ]
                    }
                ],
                vulnerabilities: [
                    {
                        title: 'SSH Weak Encryption',
                        severity: 'high',
                        description: 'SSH server is using weak encryption algorithms that may be vulnerable to attacks',
                        cve: 'CVE-2023-1234',
                        affected: '192.168.1.1:22'
                    },
                    {
                        title: 'Unencrypted Telnet Service',
                        severity: 'high',
                        description: 'Telnet service is running without encryption, credentials are transmitted in clear text',
                        cve: 'CVE-2023-5678',
                        affected: '192.168.1.100:23'
                    },
                    {
                        title: 'Anonymous FTP Access',
                        severity: 'medium',
                        description: 'FTP server allows anonymous login which may lead to unauthorized access',
                        cve: 'CVE-2023-9012',
                        affected: '192.168.1.100:21'
                    },
                    {
                        title: 'Outdated Apache Version',
                        severity: 'medium',
                        description: 'Apache HTTP Server version is outdated and may contain known vulnerabilities',
                        cve: 'CVE-2023-3456',
                        affected: '192.168.1.105:80'
                    },
                    {
                        title: 'MySQL Weak Password Policy',
                        severity: 'low',
                        description: 'MySQL server may be using weak password policies',
                        cve: 'CVE-2023-7890',
                        affected: '192.168.1.105:3306'
                    }
                ]
            };
            
            updateUI();
        }

        // Update UI with scan results
        function updateUI() {
            updateStatistics();
            updateOverviewTab();
            updatePortsTab();
            updateHostsTab();
            updateVulnerabilitiesTab();
            updateNetworkMap();
            updateRawOutput();
            createCharts();
        }

        // Update header statistics
        function updateStatistics() {
            document.getElementById('totalHosts').textContent = scanResults.hosts.length;
            
            let openPorts = 0;
            scanResults.hosts.forEach(host => {
                openPorts += host.ports.filter(p => p.status === 'open').length;
            });
            document.getElementById('openPorts').textContent = openPorts;
            
            document.getElementById('vulnCount').textContent = scanResults.vulnerabilities.length;
        }

        // Update Overview Tab
        function updateOverviewTab() {
            const vulnerabilitySummary = document.getElementById('vulnerabilitySummary');
            vulnerabilitySummary.innerHTML = '';
            
            // Group vulnerabilities by severity
            const vulnBySeverity = {
                high: scanResults.vulnerabilities.filter(v => v.severity === 'high'),
                medium: scanResults.vulnerabilities.filter(v => v.severity === 'medium'),
                low: scanResults.vulnerabilities.filter(v => v.severity === 'low')
            };
            
            // Create summary cards
            Object.keys(vulnBySeverity).forEach(severity => {
                if (vulnBySeverity[severity].length > 0) {
                    const card = document.createElement('div');
                    card.className = `vuln-card ${severity}`;
                    card.innerHTML = `
                        <div class="vuln-header">
                            <span class="vuln-title">${severity.toUpperCase()} RISK VULNERABILITIES</span>
                            <span class="vuln-severity severity-${severity}">${vulnBySeverity[severity].length}</span>
                        </div>
                        <div class="vuln-description">
                            ${vulnBySeverity[severity].length} ${severity} severity vulnerabilities found requiring immediate attention
                        </div>
                    `;
                    vulnerabilitySummary.appendChild(card);
                }
            });
        }

        // Update Ports Tab
        function updatePortsTab() {
            const tbody = document.getElementById('portsTableBody');
            tbody.innerHTML = '';
            
            scanResults.hosts.forEach(host => {
                host.ports.forEach(port => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${port.port}</td>
                        <td>${port.protocol.toUpperCase()}</td>
                        <td><span class="port-status port-${port.status}">${port.status}</span></td>
                        <td>${port.service}</td>
                        <td>${port.version}</td>
                        <td>${port.confidence}</td>
                    `;
                    tbody.appendChild(row);
                });
            });
        }

        // Update Hosts Tab
        function updateHostsTab() {
            const tbody = document.getElementById('hostsTableBody');
            tbody.innerHTML = '';
            
            scanResults.hosts.forEach(host => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${host.ip}</td>
                    <td>${host.hostname}</td>
                    <td>${host.os}</td>
                    <td>${host.uptime}</td>
                    <td>${host.lastBoot}</td>
                    <td><span class="port-status port-open">${host.status}</span></td>
                `;
                tbody.appendChild(row);
            });
        }

        // Update Vulnerabilities Tab
        function updateVulnerabilitiesTab() {
            const container = document.getElementById('vulnerabilitiesList');
            container.innerHTML = '';
            
            scanResults.vulnerabilities.forEach(vuln => {
                const card = document.createElement('div');
                card.className = `vuln-card ${vuln.severity}`;
                card.innerHTML = `
                    <div class="vuln-header">
                        <span class="vuln-title">${vuln.title}</span>
                        <span class="vuln-severity severity-${vuln.severity}">${vuln.severity.toUpperCase()}</span>
                    </div>
                    <div class="vuln-description">${vuln.description}</div>
                    <div class="vuln-cve">CVE: ${vuln.cve}</div>
                    <div style="margin-top: 10px; color: var(--text-secondary); font-size: 0.9rem;">
                        <i class="fas fa-server"></i> Affected: ${vuln.affected}
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // Update Network Map
        function updateNetworkMap() {
            const container = document.getElementById('networkGraph');
            container.innerHTML = '';
            
            // Simple network visualization using D3.js
            const width = container.offsetWidth;
            const height = container.offsetHeight;
            
            const svg = d3.select('#networkGraph')
                .append('svg')
                .attr('width', width)
                .attr('height', height);
            
            // Create nodes
            const nodes = scanResults.hosts.map((host, i) => ({
                id: host.ip,
                name: host.hostname,
                group: i === 0 ? 'router' : 'server',
                x: width / 2 + (i - 1) * 150,
                y: height / 2 + Math.sin(i) * 100
            }));
            
            // Draw connections
            svg.selectAll('.link')
                .data(nodes.slice(1))
                .enter()
                .append('line')
                .attr('class', 'link')
                .attr('x1', d => nodes[0].x)
                .attr('y1', d => nodes[0].y)
                .attr('x2', d => d.x)
                .attr('y2', d => d.y)
                .attr('stroke', '#00ff41')
                .attr('stroke-width', 2)
                .attr('opacity', 0.5);
            
            // Draw nodes
            const nodeGroups = svg.selectAll('.node')
                .data(nodes)
                .enter()
                .append('g')
                .attr('class', 'node')
                .attr('transform', d => `translate(${d.x}, ${d.y})`);
            
            nodeGroups.append('circle')
                .attr('r', d => d.group === 'router' ? 30 : 20)
                .attr('fill', d => d.group === 'router' ? '#00ffff' : '#00ff41')
                .attr('stroke', '#fff')
                .attr('stroke-width', 2);
            
            nodeGroups.append('text')
                .attr('text-anchor', 'middle')
                .attr('dy', -35)
                .attr('fill', '#fff')
                .attr('font-size', '12px')
                .text(d => d.name);
            
            nodeGroups.append('text')
                .attr('text-anchor', 'middle')
                .attr('dy', 5)
                .attr('fill', '#000')
                .attr('font-weight', 'bold')
                .text(d => d.id);
        }

        // Update Raw Output
        function updateRawOutput() {
            const container = document.getElementById('rawOutput');
            container.innerHTML = `
                <div class="terminal-line">
                    <span class="terminal-command"># Nmap 7.92 scan initiated Thu Jan 25 10:30:15 2024</span>
                </div>
                <div class="terminal-line">
                    <span class="terminal-command">nmap -sS -sV -O -T4 192.168.1.0/24</span>
                </div>
                <div class="terminal-line"> </div>
                ${scanResults.hosts.map(host => `
                    <div class="terminal-line">
                        <span class="terminal-command">Nmap scan report for ${host.hostname} (${host.ip})</span>
                    </div>
                    <div class="terminal-line">
                        <span class="terminal-result">Host is up (${host.uptime} uptime).</span>
                    </div>
                    <div class="terminal-line">
                        <span class="terminal-result">Not shown: ${995 - host.ports.length} closed ports</span>
                    </div>
                    <div class="terminal-line">
                        <span class="terminal-result">PORT     STATE SERVICE    VERSION</span>
                    </div>
                    ${host.ports.map(port => `
                        <div class="terminal-line">
                            <span class="terminal-result">${port.port}/${port.protocol}  ${port.status.padEnd(5)} ${port.service.padEnd(10)} ${port.version}</span>
                        </div>
                    `).join('')}
                    <div class="terminal-line">
                        <span class="terminal-result">OS details: ${host.os}</span>
                    </div>
                    <div class="terminal-line"> </div>
                `).join('')}
                <div class="terminal-line">
                    <span class="terminal-command">Scan completed: 3 hosts up.</span>
                </div>
            `;
        }

        // Create Charts
        function createCharts() {
            // Port Status Chart
            const portCtx = document.getElementById('portChart').getContext('2d');
            
            let openPorts = 0, closedPorts = 0, filteredPorts = 0;
            scanResults.hosts.forEach(host => {
                host.ports.forEach(port => {
                    if (port.status === 'open') openPorts++;
                    else if (port.status === 'closed') closedPorts++;
                    else filteredPorts++;
                });
            });
            
            if (portChart) portChart.destroy();
            portChart = new Chart(portCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Open', 'Closed', 'Filtered'],
                    datasets: [{
                        data: [openPorts, closedPorts, filteredPorts],
                        backgroundColor: ['#00ff41', '#ff0040', '#ffaa00'],
                        borderColor: '#0a0a0f',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#fff'
                            }
                        }
                    }
                }
            });
            
            // Service Distribution Chart
            const serviceCtx = document.getElementById('serviceChart').getContext('2d');
            const services = {};
            
            scanResults.hosts.forEach(host => {
                host.ports.forEach(port => {
                    if (port.status === 'open') {
                        services[port.service] = (services[port.service] || 0) + 1;
                    }
                });
            });
            
            if (serviceChart) serviceChart.destroy();
            serviceChart = new Chart(serviceCtx, {
                type: 'bar',
                data: {
                    labels: Object.keys(services),
                    datasets: [{
                        label: 'Services',
                        data: Object.values(services),
                        backgroundColor: '#00ffff',
                        borderColor: '#00ffff',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: '#fff'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                color: '#fff'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // Switch tabs
        function switchTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`${tabName}-tab`).classList.add('active');
        }

        // Export results
        function exportResults(format) {
            let content, filename, type;
            
            switch(format) {
                case 'json':
                    content = JSON.stringify(scanResults, null, 2);
                    filename = 'nmap_results.json';
                    type = 'application/json';
                    break;
                case 'csv':
                    content = convertToCSV();
                    filename = 'nmap_results.csv';
                    type = 'text/csv';
                    break;
                case 'xml':
                    content = convertToXML();
                    filename = 'nmap_results.xml';
                    type = 'text/xml';
                    break;
            }
            
            downloadFile(content, filename, type);
            showToast(`Results exported as ${format.toUpperCase()}`, 'success');
        }

        // Convert to CSV
        function convertToCSV() {
            let csv = 'IP,Hostname,OS,Port,Protocol,Status,Service,Version\n';
            
            scanResults.hosts.forEach(host => {
                host.ports.forEach(port => {
                    csv += `${host.ip},${host.hostname},${host.os},${port.port},${port.protocol},${port.status},${port.service},"${port.version}"\n`;
                });
            });
            
            return csv;
        }

        // Convert to XML
        function convertToXML() {
            let xml = '<?xml version="1.0" encoding="UTF-8"?>\n<nmapresults>\n';
            
            scanResults.hosts.forEach(host => {
                xml += `  <host>\n`;
                xml += `    <ip>${host.ip}</ip>\n`;
                xml += `    <hostname>${host.hostname}</hostname>\n`;
                xml += `    <os>${host.os}</os>\n`;
                xml += `    <ports>\n`;
                
                host.ports.forEach(port => {
                    xml += `      <port>\n`;
                    xml += `        <number>${port.port}</number>\n`;
                    xml += `        <protocol>${port.protocol}</protocol>\n`;
                    xml += `        <status>${port.status}</status>\n`;
                    xml += `        <service>${port.service}</service>\n`;
                    xml += `        <version>${port.version}</version>\n`;
                    xml += `      </port>\n`;
                });
                
                xml += `    </ports>\n`;
                xml += `  </host>\n`;
            });
            
            xml += '</nmapresults>';
            return xml;
        }

        // Download file
        function downloadFile(content, filename, type) {
            const blob = new Blob([content], { type: type });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Generate report
        function generateReport() {
            showToast('Generating PDF report...', 'success');
            // In a real implementation, this would generate a PDF report
            setTimeout(() => {
                showToast('PDF report generated successfully', 'success');
            }, 2000);
        }

        // Show toast notification
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const icon = toast.querySelector('.toast-icon i');
            const title = toast.querySelector('.toast-title');
            const msg = toast.querySelector('.toast-message');
            
            // Update toast content
            toast.className = `toast ${type}`;
            
            switch(type) {
                case 'success':
                    icon.className = 'fas fa-check-circle';
                    title.textContent = 'Success';
                    break;
                case 'error':
                    icon.className = 'fas fa-times-circle';
                    title.textContent = 'Error';
                    break;
                case 'warning':
                    icon.className = 'fas fa-exclamation-triangle';
                    title.textContent = 'Warning';
                    break;
            }
            
            msg.textContent = message;
            
            // Show toast
            toast.classList.add('show');
            
            // Hide after 3 seconds
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Initialize
        updateCommandPreview();
    </script>
</body>
</html>