<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Security Analyzer - Educational Tool</title>
    
    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-red: #ff0040;
            --primary-green: #00ff41;
            --primary-yellow: #ffaa00;
            --primary-cyan: #00ffff;
            --primary-purple: #b026ff;
            --dark-bg: #0a0a0a;
            --card-bg: rgba(20, 20, 30, 0.95);
            --border-color: rgba(255, 0, 64, 0.3);
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --danger-bg: rgba(255, 0, 64, 0.1);
            --warning-bg: rgba(255, 170, 0, 0.1);
            --success-bg: rgba(0, 255, 65, 0.1);
        }

        body {
            font-family: 'Courier New', monospace;
            background: var(--dark-bg);
            color: var(--text-primary);
            min-height: 100vh;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(255, 0, 64, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 90% 80%, rgba(0, 255, 65, 0.1) 0%, transparent 50%);
        }

        /* Warning Banner */
        .warning-banner {
            background: linear-gradient(90deg, var(--danger-bg), var(--warning-bg));
            border: 1px solid var(--primary-red);
            padding: 15px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .warning-banner::before {
            content: '⚠️';
            position: absolute;
            left: 20px;
            font-size: 1.5rem;
            animation: pulse 2s infinite;
        }

        .warning-text {
            color: var(--primary-yellow);
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.7; }
        }

        /* Header */
        header {
            background: linear-gradient(180deg, rgba(10, 10, 10, 0.95), rgba(10, 10, 10, 0.8));
            backdrop-filter: blur(10px);
            border-bottom: 2px solid var(--border-color);
            padding: 20px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary-red);
            text-shadow: 0 0 20px var(--primary-red);
        }

        .logo i {
            font-size: 2rem;
            animation: rotate 10s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .mode-selector {
            display: flex;
            gap: 10px;
        }

        .mode-btn {
            padding: 8px 16px;
            background: rgba(255, 0, 64, 0.1);
            border: 1px solid var(--primary-red);
            border-radius: 5px;
            color: var(--primary-red);
            cursor: pointer;
            transition: all 0.3s;
        }

        .mode-btn.active {
            background: var(--primary-red);
            color: var(--dark-bg);
        }

        .mode-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 0, 64, 0.3);
        }

        /* Main Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        /* Main Tool Section */
        .tool-section {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
        }

        .section-title {
            font-size: 1.8rem;
            color: var(--primary-red);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Password Input Section */
        .password-input-section {
            margin-bottom: 30px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            color: var(--primary-cyan);
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.9rem;
        }

        .password-input-container {
            position: relative;
            display: flex;
            gap: 10px;
        }

        .password-input {
            flex: 1;
            padding: 15px;
            background: rgba(255, 0, 64, 0.05);
            border: 2px solid var(--border-color);
            border-radius: 10px;
            color: var(--text-primary);
            font-family: 'Courier New', monospace;
            font-size: 1.2rem;
            transition: all 0.3s;
        }

        .password-input:focus {
            outline: none;
            border-color: var(--primary-red);
            box-shadow: 0 0 20px rgba(255, 0, 64, 0.3);
            background: rgba(255, 0, 64, 0.1);
        }

        .toggle-visibility {
            padding: 15px 20px;
            background: rgba(0, 255, 255, 0.1);
            border: 1px solid var(--primary-cyan);
            border-radius: 10px;
            color: var(--primary-cyan);
            cursor: pointer;
            transition: all 0.3s;
        }

        .toggle-visibility:hover {
            background: rgba(0, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        /* Password Strength Meter */
        .strength-meter {
            margin: 20px 0;
        }

        .strength-bar {
            height: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }

        .strength-fill {
            height: 100%;
            width: 0%;
            transition: all 0.5s ease;
            border-radius: 15px;
            position: relative;
            overflow: hidden;
        }

        .strength-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .strength-weak { background: linear-gradient(90deg, var(--primary-red), #ff6666); }
        .strength-fair { background: linear-gradient(90deg, var(--primary-yellow), #ffcc66); }
        .strength-good { background: linear-gradient(90deg, var(--primary-cyan), #66ccff); }
        .strength-strong { background: linear-gradient(90deg, var(--primary-green), #66ff66); }

        .strength-label {
            margin-top: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        /* Analysis Grid */
        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .analysis-card {
            background: rgba(255, 0, 64, 0.05);
            border: 1px solid rgba(255, 0, 64, 0.2);
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s;
        }

        .analysis-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(255, 0, 64, 0.2);
            border-color: var(--primary-red);
        }

        .analysis-card h3 {
            color: var(--primary-cyan);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .analysis-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-red);
            margin: 10px 0;
        }

        .analysis-description {
            color: var(--text-secondary);
            line-height: 1.5;
        }

        /* Cracking Methods */
        .methods-section {
            margin-top: 30px;
        }

        .method-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }

        .method-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .method-title {
            font-size: 1.3rem;
            color: var(--primary-cyan);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .method-status {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        .status-ready {
            background: rgba(0, 255, 65, 0.2);
            color: var(--primary-green);
        }

        .status-running {
            background: rgba(255, 170, 0, 0.2);
            color: var(--primary-yellow);
            animation: blink 1s infinite;
        }

        .status-found {
            background: rgba(255, 0, 64, 0.2);
            color: var(--primary-red);
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .method-description {
            color: var(--text-secondary);
            margin-bottom: 15px;
        }

        .method-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--primary-red), var(--primary-purple));
            color: var(--text-primary);
        }

        .btn-secondary {
            background: transparent;
            border: 2px solid var(--primary-cyan);
            color: var(--primary-cyan);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(255, 0, 64, 0.4);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Progress Bar */
        .progress-container {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            height: 20px;
            overflow: hidden;
            position: relative;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-red), var(--primary-purple));
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 10px;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: var(--text-primary);
            font-size: 0.8rem;
            font-weight: bold;
        }

        /* Results Section */
        .results-section {
            display: none;
            margin-top: 30px;
            animation: fadeIn 0.5s ease;
        }

        .results-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .result-title {
            color: var(--primary-green);
            font-size: 1.2rem;
            font-weight: bold;
        }

        .result-time {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .result-content {
            color: var(--text-primary);
            line-height: 1.6;
        }

        /* Hash Display */
        .hash-display {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid var(--primary-cyan);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            word-break: break-all;
            color: var(--primary-cyan);
        }

        /* Common Passwords */
        .common-passwords {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }

        .password-item {
            background: rgba(255, 0, 64, 0.05);
            border: 1px solid rgba(255, 0, 64, 0.2);
            border-radius: 5px;
            padding: 10px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
        }

        .password-item:hover {
            background: rgba(255, 0, 64, 0.1);
            transform: scale(1.05);
        }

        .password-item.matched {
            background: rgba(255, 0, 64, 0.3);
            border-color: var(--primary-red);
            animation: pulse 1s infinite;
        }

        /* Charts */
        .chart-container {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            height: 400px;
        }

        /* Recommendations */
        .recommendations {
            background: var(--success-bg);
            border: 1px solid var(--primary-green);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .recommendations h3 {
            color: var(--primary-green);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .recommendation-list {
            list-style: none;
        }

        .recommendation-list li {
            padding: 10px 0;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .recommendation-list li::before {
            content: '✓';
            color: var(--primary-green);
            font-weight: bold;
            font-size: 1.2rem;
        }

        /* Terminal Output */
        .terminal {
            background: #000;
            border: 1px solid var(--primary-green);
            border-radius: 10px;
            padding: 20px;
            font-family: 'Courier New', monospace;
            max-height: 300px;
            overflow-y: auto;
            margin: 20px 0;
        }

        .terminal-line {
            margin: 5px 0;
            color: var(--primary-green);
            font-size: 0.9rem;
        }

        .terminal-command {
            color: var(--primary-cyan);
        }

        .terminal-result {
            color: var(--text-primary);
        }

        .terminal-error {
            color: var(--primary-red);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 20px;
            }

            .analysis-grid {
                grid-template-columns: 1fr;
            }

            .method-controls {
                flex-direction: column;
            }

            .common-passwords {
                grid-template-columns: 1fr;
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--dark-bg);
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, var(--primary-red), var(--primary-purple));
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(180deg, var(--primary-purple), var(--primary-red));
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary-red);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Warning Banner -->
    <div class="warning-banner">
        <div class="warning-text">
            Educational Tool Only - Use Only for Authorized Security Testing & Educational Purposes
        </div>
    </div>

    <!-- Header -->
    <header>
        <div class="header-content">
            <div class="logo">
                <i class="fas fa-key"></i>
                <span>Password Security Analyzer</span>
            </div>
            <div class="mode-selector">
                <button class="mode-btn active" onclick="switchMode('analyze')">
                    <i class="fas fa-shield-alt"></i> Analyze
                </button>
                <button class="mode-btn" onclick="switchMode('crack')">
                    <i class="fas fa-unlock"></i> Test
                </button>
                <button class="mode-btn" onclick="switchMode('generate')">
                    <i class="fas fa-random"></i> Generate
                </button>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="container">
        <!-- Password Analysis Section -->
        <section class="tool-section" id="analyzeSection">
            <h2 class="section-title">
                <i class="fas fa-search"></i>
                Password Strength Analysis
            </h2>

            <div class="password-input-section">
                <div class="input-group">
                    <label for="passwordInput">Enter Password to Analyze</label>
                    <div class="password-input-container">
                        <input type="password" id="passwordInput" class="password-input" 
                               placeholder="Enter password..." oninput="analyzePassword()">
                        <button class="toggle-visibility" onclick="togglePasswordVisibility()">
                            <i class="fas fa-eye" id="visibilityIcon"></i>
                        </button>
                    </div>
                </div>

                <div class="strength-meter">
                    <div class="strength-bar">
                        <div class="strength-fill" id="strengthFill"></div>
                    </div>
                    <div class="strength-label" id="strengthLabel">Enter a password</div>
                </div>
            </div>

            <div class="analysis-grid">
                <div class="analysis-card">
                    <h3><i class="fas fa-ruler"></i> Length</h3>
                    <div class="analysis-value" id="lengthValue">0</div>
                    <div class="analysis-description">Minimum 12 characters recommended</div>
                </div>

                <div class="analysis-card">
                    <h3><i class="fas fa-layer-group"></i> Complexity</h3>
                    <div class="analysis-value" id="complexityValue">0%</div>
                    <div class="analysis-description">Mix of character types</div>
                </div>

                <div class="analysis-card">
                    <h3><i class="fas fa-clock"></i> Crack Time</h3>
                    <div class="analysis-value" id="crackTimeValue">-</div>
                    <div class="analysis-description">Estimated time to crack</div>
                </div>

                <div class="analysis-card">
                    <h3><i class="fas fa-fingerprint"></i> Entropy</h3>
                    <div class="analysis-value" id="entropyValue">0</div>
                    <div class="analysis-description">Bits of entropy</div>
                </div>
            </div>

            <div class="recommendations" id="recommendations" style="display: none;">
                <h3><i class="fas fa-lightbulb"></i> Security Recommendations</h3>
                <ul class="recommendation-list" id="recommendationList">
                    <!-- Recommendations will be added here -->
                </ul>
            </div>
        </section>

        <!-- Password Testing Section -->
        <section class="tool-section" id="crackSection" style="display: none;">
            <h2 class="section-title">
                <i class="fas fa-unlock-alt"></i>
                Password Security Testing
            </h2>

            <div class="password-input-section">
                <div class="input-group">
                    <label for="hashInput">Enter Hash to Test</label>
                    <select id="hashType" style="margin-bottom: 10px; padding: 10px; background: var(--card-bg); border: 1px solid var(--border-color); color: var(--text-primary); border-radius: 5px;">
                        <option value="md5">MD5</option>
                        <option value="sha1">SHA-1</option>
                        <option value="sha256">SHA-256</option>
                    </select>
                    <input type="text" id="hashInput" class="password-input" 
                           placeholder="Enter hash to test...">
                </div>
            </div>

            <div class="methods-section">
                <!-- Dictionary Attack -->
                <div class="method-card">
                    <div class="method-header">
                        <div class="method-title">
                            <i class="fas fa-book"></i>
                            Dictionary Attack
                        </div>
                        <div class="method-status status-ready" id="dictStatus">Ready</div>
                    </div>
                    <div class="method-description">
                        Tests against common passwords and dictionary words
                    </div>
                    <div class="method-controls">
                        <button class="btn btn-primary" onclick="startDictionaryAttack()">
                            <i class="fas fa-play"></i> Start Attack
                        </button>
                        <div class="progress-container" id="dictProgress" style="display: none;">
                            <div class="progress-bar" id="dictProgressBar"></div>
                            <div class="progress-text" id="dictProgressText">0%</div>
                        </div>
                    </div>
                </div>

                <!-- Brute Force Attack -->
                <div class="method-card">
                    <div class="method-header">
                        <div class="method-title">
                            <i class="fas fa-hammer"></i>
                            Brute Force Attack
                        </div>
                        <div class="method-status status-ready" id="bruteStatus">Ready</div>
                    </div>
                    <div class="method-description">
                        Tests all possible character combinations
                    </div>
                    <div class="method-controls">
                        <button class="btn btn-primary" onclick="startBruteForce()">
                            <i class="fas fa-play"></i> Start Attack
                        </button>
                        <div class="progress-container" id="bruteProgress" style="display: none;">
                            <div class="progress-bar" id="bruteProgressBar"></div>
                            <div class="progress-text" id="bruteProgressText">0%</div>
                        </div>
                    </div>
                </div>

                <!-- Rainbow Table -->
                <div class="method-card">
                    <div class="method-header">
                        <div class="method-title">
                            <i class="fas fa-table"></i>
                            Rainbow Table Lookup
                        </div>
                        <div class="method-status status-ready" id="rainbowStatus">Ready</div>
                    </div>
                    <div class="method-description">
                        Uses precomputed hash tables for faster cracking
                    </div>
                    <div class="method-controls">
                        <button class="btn btn-primary" onclick="startRainbowTable()">
                            <i class="fas fa-play"></i> Start Lookup
                        </button>
                        <div class="progress-container" id="rainbowProgress" style="display: none;">
                            <div class="progress-bar" id="rainbowProgressBar"></div>
                            <div class="progress-text" id="rainbowProgressText">0%</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Results -->
            <div class="results-section" id="crackResults">
                <div class="result-card">
                    <div class="result-header">
                        <div class="result-title">
                            <i class="fas fa-check-circle"></i> Password Found!
                        </div>
                        <div class="result-time" id="crackTime">Time: 0.00s</div>
                    </div>
                    <div class="result-content">
                        <p><strong>Original Password:</strong> <span id="foundPassword"></span></p>
                        <p><strong>Method Used:</strong> <span id="crackMethod"></span></p>
                        <p><strong>Attempts:</strong> <span id="crackAttempts"></span></p>
                    </div>
                </div>
            </div>

            <div class="terminal" id="crackTerminal" style="display: none;">
                <div class="terminal-line">
                    <span class="terminal-command">$</span> 
                    <span class="terminal-result">Starting password recovery...</span>
                </div>
                <div id="terminalOutput"></div>
            </div>
        </section>

        <!-- Password Generator Section -->
        <section class="tool-section" id="generateSection" style="display: none;">
            <h2 class="section-title">
                <i class="fas fa-random"></i>
                Secure Password Generator
            </h2>

            <div class="analysis-grid">
                <div class="analysis-card">
                    <h3><i class="fas fa-sliders-h"></i> Password Length</h3>
                    <input type="range" id="lengthSlider" min="8" max="32" value="16" 
                           style="width: 100%; margin: 10px 0;" oninput="updateLength()">
                    <div style="text-align: center; font-size: 1.5rem; color: var(--primary-cyan);" id="lengthDisplay">16</div>
                </div>

                <div class="analysis-card">
                    <h3><i class="fas fa-cogs"></i> Character Options</h3>
                    <label style="display: block; margin: 10px 0;">
                        <input type="checkbox" id="uppercase" checked> Uppercase (A-Z)
                    </label>
                    <label style="display: block; margin: 10px 0;">
                        <input type="checkbox" id="lowercase" checked> Lowercase (a-z)
                    </label>
                    <label style="display: block; margin: 10px 0;">
                        <input type="checkbox" id="numbers" checked> Numbers (0-9)
                    </label>
                    <label style="display: block; margin: 10px 0;">
                        <input type="checkbox" id="symbols" checked> Symbols (!@#$%)
                    </label>
                </div>
            </div>

            <div style="text-align: center; margin: 30px 0;">
                <button class="btn btn-primary" onclick="generatePassword()" style="font-size: 1.2rem; padding: 15px 40px;">
                    <i class="fas fa-magic"></i> Generate Password
                </button>
            </div>

            <div class="hash-display" id="generatedPassword" style="display: none;">
                <!-- Generated password will appear here -->
            </div>

            <div class="chart-container">
                <canvas id="passwordChart"></canvas>
            </div>
        </section>

        <!-- Common Passwords Section -->
        <section class="tool-section">
            <h2 class="section-title">
                <i class="fas fa-exclamation-triangle"></i>
                Top 100 Most Common Passwords
            </h2>

            <div class="common-passwords" id="commonPasswords">
                <!-- Common passwords will be loaded here -->
            </div>
        </section>
    </div>

    <script>
        // Common passwords list
        const commonPasswords = [
            '123456', 'password', '123456789', '12345678', '12345', '111111',
            '1234567', 'sunshine', 'qwerty', 'iloveyou', 'princess', 'admin',
            'welcome', '666666', 'abc123', 'football', '123123', 'monkey',
            '654321', '!@#$%^&*', 'password1', 'qwertyuiop', 'starwars',
            '1234', 'dragon', 'master', 'hello', 'freedom', 'whatever',
            'qazwsx', 'trustno1', '123qwe', '1q2w3e4r', 'zxcvbnm',
            '1qaz2wsx', '123abc', 'password123', 'admin123', 'root',
            'toor', 'pass', 'test', 'guest', 'user', 'demo'
        ];

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadCommonPasswords();
            initializeCharts();
        });

        // Switch between modes
        function switchMode(mode) {
            // Hide all sections
            document.getElementById('analyzeSection').style.display = 'none';
            document.getElementById('crackSection').style.display = 'none';
            document.getElementById('generateSection').style.display = 'none';
            
            // Show selected section
            document.getElementById(mode + 'Section').style.display = 'block';
            
            // Update button states
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.closest('.mode-btn').classList.add('active');
        }

        // Toggle password visibility
        function togglePasswordVisibility() {
            const input = document.getElementById('passwordInput');
            const icon = document.getElementById('visibilityIcon');
            
            if (input.type === 'password') {
                input.type = 'text';
                icon.className = 'fas fa-eye-slash';
            } else {
                input.type = 'password';
                icon.className = 'fas fa-eye';
            }
        }

        // Analyze password strength
        function analyzePassword() {
            const password = document.getElementById('passwordInput').value;
            
            if (!password) {
                resetAnalysis();
                return;
            }
            
            // Calculate strength metrics
            const length = password.length;
            const complexity = calculateComplexity(password);
            const entropy = calculateEntropy(password);
            const crackTime = estimateCrackTime(entropy);
            
            // Update UI
            updateStrengthMeter(complexity);
            updateAnalysisCards(length, complexity, crackTime, entropy);
            updateRecommendations(password);
        }

        // Calculate password complexity
        function calculateComplexity(password) {
            let score = 0;
            let hasUpper = /[A-Z]/.test(password);
            let hasLower = /[a-z]/.test(password);
            let hasNumber = /[0-9]/.test(password);
            let hasSymbol = /[^A-Za-z0-9]/.test(password);
            
            // Length bonus
            score += Math.min(password.length * 5, 50);
            
            // Character type bonus
            if (hasUpper) score += 15;
            if (hasLower) score += 15;
            if (hasNumber) score += 15;
            if (hasSymbol) score += 20;
            
            // Penalty for common patterns
            if (isCommonPassword(password)) score -= 30;
            if (isSequential(password)) score -= 20;
            if (isRepeating(password)) score -= 15;
            
            return Math.max(0, Math.min(100, score));
        }

        // Calculate entropy
        function calculateEntropy(password) {
            let charset = 0;
            if (/[a-z]/.test(password)) charset += 26;
            if (/[A-Z]/.test(password)) charset += 26;
            if (/[0-9]/.test(password)) charset += 10;
            if (/[^A-Za-z0-9]/.test(password)) charset += 32;
            
            return password.length * Math.log2(charset);
        }

        // Estimate crack time
        function estimateCrackTime(entropy) {
            const guessesPerSecond = 1000000000000; // 1 trillion guesses/sec (high-end GPU)
            const combinations = Math.pow(2, entropy);
            const seconds = combinations / (2 * guessesPerSecond);
            
            if (seconds < 1) return 'Instant';
            if (seconds < 60) return Math.round(seconds) + ' seconds';
            if (seconds < 3600) return Math.round(seconds / 60) + ' minutes';
            if (seconds < 86400) return Math.round(seconds / 3600) + ' hours';
            if (seconds < 2592000) return Math.round(seconds / 86400) + ' days';
            if (seconds < 31536000) return Math.round(seconds / 2592000) + ' months';
            if (seconds < 3153600000) return Math.round(seconds / 31536000) + ' years';
            return 'Centuries';
        }

        // Check if password is common
        function isCommonPassword(password) {
            return commonPasswords.includes(password.toLowerCase());
        }

        // Check for sequential characters
        function isSequential(password) {
            for (let i = 0; i < password.length - 2; i++) {
                const char1 = password.charCodeAt(i);
                const char2 = password.charCodeAt(i + 1);
                const char3 = password.charCodeAt(i + 2);
                
                if (char2 === char1 + 1 && char3 === char2 + 1) return true;
                if (char2 === char1 - 1 && char3 === char2 - 1) return true;
            }
            return false;
        }

        // Check for repeating characters
        function isRepeating(password) {
            for (let i = 0; i < password.length - 2; i++) {
                if (password[i] === password[i + 1] && password[i] === password[i + 2]) {
                    return true;
                }
            }
            return false;
        }

        // Update strength meter
        function updateStrengthMeter(complexity) {
            const fill = document.getElementById('strengthFill');
            const label = document.getElementById('strengthLabel');
            
            fill.style.width = complexity + '%';
            
            if (complexity < 25) {
                fill.className = 'strength-fill strength-weak';
                label.textContent = 'WEAK';
                label.style.color = '#ff0040';
            } else if (complexity < 50) {
                fill.className = 'strength-fill strength-fair';
                label.textContent = 'FAIR';
                label.style.color = '#ffaa00';
            } else if (complexity < 75) {
                fill.className = 'strength-fill strength-good';
                label.textContent = 'GOOD';
                label.style.color = '#00ffff';
            } else {
                fill.className = 'strength-fill strength-strong';
                label.textContent = 'STRONG';
                label.style.color = '#00ff41';
            }
        }

        // Update analysis cards
        function updateAnalysisCards(length, complexity, crackTime, entropy) {
            document.getElementById('lengthValue').textContent = length;
            document.getElementById('complexityValue').textContent = Math.round(complexity) + '%';
            document.getElementById('crackTimeValue').textContent = crackTime;
            document.getElementById('entropyValue').textContent = Math.round(entropy) + ' bits';
        }

        // Update recommendations
        function updateRecommendations(password) {
            const recommendations = document.getElementById('recommendations');
            const list = document.getElementById('recommendationList');
            const recs = [];
            
            if (password.length < 12) {
                recs.push('Use at least 12 characters');
            }
            if (!/[A-Z]/.test(password)) {
                recs.push('Include uppercase letters');
            }
            if (!/[a-z]/.test(password)) {
                recs.push('Include lowercase letters');
            }
            if (!/[0-9]/.test(password)) {
                recs.push('Include numbers');
            }
            if (!/[^A-Za-z0-9]/.test(password)) {
                recs.push('Include special characters');
            }
            if (isCommonPassword(password)) {
                recs.push('Avoid common passwords');
            }
            if (isSequential(password)) {
                recs.push('Avoid sequential characters');
            }
            if (isRepeating(password)) {
                recs.push('Avoid repeating characters');
            }
            
            if (recs.length > 0) {
                list.innerHTML = recs.map(rec => `<li>${rec}</li>`).join('');
                recommendations.style.display = 'block';
            } else {
                recommendations.style.display = 'none';
            }
        }

        // Reset analysis
        function resetAnalysis() {
            document.getElementById('strengthFill').style.width = '0%';
            document.getElementById('strengthLabel').textContent = 'Enter a password';
            document.getElementById('lengthValue').textContent = '0';
            document.getElementById('complexityValue').textContent = '0%';
            document.getElementById('crackTimeValue').textContent = '-';
            document.getElementById('entropyValue').textContent = '0';
            document.getElementById('recommendations').style.display = 'none';
        }

        // Dictionary attack simulation
        function startDictionaryAttack() {
            const hashInput = document.getElementById('hashInput').value;
            if (!hashInput) {
                alert('Please enter a hash to test');
                return;
            }
            
            const status = document.getElementById('dictStatus');
            const progress = document.getElementById('dictProgress');
            const progressBar = document.getElementById('dictProgressBar');
            const progressText = document.getElementById('dictProgressText');
            
            status.className = 'method-status status-running';
            status.textContent = 'Running';
            progress.style.display = 'block';
            
            let attempts = 0;
            const totalAttempts = commonPasswords.length;
            let found = false;
            
            const interval = setInterval(() => {
                attempts++;
                const progressPercent = (attempts / totalAttempts) * 100;
                progressBar.style.width = progressPercent + '%';
                progressText.textContent = Math.round(progressPercent) + '%';
                
                // Simulate checking
                const testPassword = commonPasswords[attempts - 1];
                const hashType = document.getElementById('hashType').value;
                const testHash = hashPassword(testPassword, hashType);
                
                if (testHash === hashInput.toLowerCase()) {
                    found = true;
                    clearInterval(interval);
                    showCrackResult(testPassword, 'Dictionary Attack', attempts);
                    status.className = 'method-status status-found';
                    status.textContent = 'Found';
                    addTerminalLine(`[SUCCESS] Password found: ${testPassword}`, 'terminal-result');
                    return;
                }
                
                if (attempts >= totalAttempts) {
                    clearInterval(interval);
                    status.className = 'method-status status-ready';
                    status.textContent = 'Not Found';
                    addTerminalLine('[FAILED] Password not found in dictionary', 'terminal-error');
                }
            }, 10);
            
            showTerminal();
            addTerminalLine('[INFO] Starting dictionary attack...', 'terminal-command');
        }

        // Brute force attack simulation
        function startBruteForce() {
            const status = document.getElementById('bruteStatus');
            const progress = document.getElementById('bruteProgress');
            const progressBar = document.getElementById('bruteProgressBar');
            const progressText = document.getElementById('bruteProgressText');
            
            status.className = 'method-status status-running';
            status.textContent = 'Running';
            progress.style.display = 'block';
            
            // Simulate brute force (limited for demo)
            let attempts = 0;
            const maxAttempts = 10000;
            
            const interval = setInterval(() => {
                attempts += 100;
                const progressPercent = Math.min((attempts / maxAttempts) * 100, 100);
                progressBar.style.width = progressPercent + '%';
                progressText.textContent = Math.round(progressPercent) + '%';
                
                if (attempts >= maxAttempts) {
                    clearInterval(interval);
                    status.className = 'method-status status-ready';
                    status.textContent = 'Stopped';
                    addTerminalLine('[INFO] Brute force simulation completed', 'terminal-command');
                }
            }, 50);
            
            showTerminal();
            addTerminalLine('[INFO] Starting brute force attack...', 'terminal-command');
            addTerminalLine('[WARNING] This may take a very long time', 'terminal-error');
        }

        // Rainbow table attack simulation
        function startRainbowTable() {
            const status = document.getElementById('rainbowStatus');
            const progress = document.getElementById('rainbowProgress');
            const progressBar = document.getElementById('rainbowProgressBar');
            const progressText = document.getElementById('rainbowProgressText');
            
            status.className = 'method-status status-running';
            status.textContent = 'Running';
            progress.style.display = 'block';
            
            let progressValue = 0;
            const interval = setInterval(() => {
                progressValue += 5;
                progressBar.style.width = progressValue + '%';
                progressText.textContent = progressValue + '%';
                
                if (progressValue >= 100) {
                    clearInterval(interval);
                    status.className = 'method-status status-ready';
                    status.textContent = 'Complete';
                    addTerminalLine('[INFO] Rainbow table lookup completed', 'terminal-command');
                }
            }, 100);
            
            showTerminal();
            addTerminalLine('[INFO] Searching rainbow tables...', 'terminal-command');
        }

        // Hash password function
        function hashPassword(password, algorithm) {
            switch(algorithm) {
                case 'md5':
                    return CryptoJS.MD5(password).toString();
                case 'sha1':
                    return CryptoJS.SHA1(password).toString();
                case 'sha256':
                    return CryptoJS.SHA256(password).toString();
                default:
                    return '';
            }
        }

        // Show crack result
        function showCrackResult(password, method, attempts) {
            const results = document.getElementById('crackResults');
            document.getElementById('foundPassword').textContent = password;
            document.getElementById('crackMethod').textContent = method;
            document.getElementById('crackAttempts').textContent = attempts.toLocaleString();
            results.classList.add('active');
        }

        // Show terminal
        function showTerminal() {
            document.getElementById('crackTerminal').style.display = 'block';
            document.getElementById('terminalOutput').innerHTML = '';
        }

        // Add terminal line
        function addTerminalLine(text, className = '') {
            const output = document.getElementById('terminalOutput');
            const line = document.createElement('div');
            line.className = 'terminal-line ' + className;
            line.textContent = text;
            output.appendChild(line);
            output.scrollTop = output.scrollHeight;
        }

        // Generate password
        function generatePassword() {
            const length = parseInt(document.getElementById('lengthSlider').value);
            const useUpper = document.getElementById('uppercase').checked;
            const useLower = document.getElementById('lowercase').checked;
            const useNumbers = document.getElementById('numbers').checked;
            const useSymbols = document.getElementById('symbols').checked;
            
            let charset = '';
            if (useLower) charset += 'abcdefghijklmnopqrstuvwxyz';
            if (useUpper) charset += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            if (useNumbers) charset += '0123456789';
            if (useSymbols) charset += '!@#$%^&*()_+-=[]{}|;:,.<>?';
            
            if (!charset) {
                alert('Please select at least one character type');
                return;
            }
            
            let password = '';
            for (let i = 0; i < length; i++) {
                password += charset.charAt(Math.floor(Math.random() * charset.length));
            }
            
            const display = document.getElementById('generatedPassword');
            display.innerHTML = `
                <strong>Generated Password:</strong><br>
                <span style="font-size: 1.5rem; color: var(--primary-green);">${password}</span><br><br>
                <strong>Entropy:</strong> ${calculateEntropy(password).toFixed(1)} bits<br>
                <strong>Estimated Crack Time:</strong> ${estimateCrackTime(calculateEntropy(password))}
            `;
            display.style.display = 'block';
            
            updatePasswordChart(password);
        }

        // Update length display
        function updateLength() {
            const length = document.getElementById('lengthSlider').value;
            document.getElementById('lengthDisplay').textContent = length;
        }

        // Load common passwords
        function loadCommonPasswords() {
            const container = document.getElementById('commonPasswords');
            commonPasswords.forEach(password => {
                const div = document.createElement('div');
                div.className = 'password-item';
                div.textContent = password;
                div.onclick = function() {
                    document.getElementById('passwordInput').value = password;
                    analyzePassword();
                    this.classList.add('matched');
                    setTimeout(() => this.classList.remove('matched'), 1000);
                };
                container.appendChild(div);
            });
        }

        // Initialize charts
        let passwordChart = null;
        function initializeCharts() {
            const ctx = document.getElementById('passwordChart');
            if (!ctx) return;
            
            passwordChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Length', 'Uppercase', 'Lowercase', 'Numbers', 'Symbols'],
                    datasets: [{
                        label: 'Password Strength Components',
                        data: [0, 0, 0, 0, 0],
                        backgroundColor: [
                            'rgba(255, 0, 64, 0.6)',
                            'rgba(0, 255, 65, 0.6)',
                            'rgba(0, 255, 255, 0.6)',
                            'rgba(255, 170, 0, 0.6)',
                            'rgba(176, 38, 255, 0.6)'
                        ],
                        borderColor: [
                            'rgba(255, 0, 64, 1)',
                            'rgba(0, 255, 65, 1)',
                            'rgba(0, 255, 255, 1)',
                            'rgba(255, 170, 0, 1)',
                            'rgba(176, 38, 255, 1)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                color: '#fff'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                color: '#fff'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // Update password chart
        function updatePasswordChart(password) {
            if (!passwordChart) return;
            
            const lengthScore = Math.min((password.length / 32) * 100, 100);
            const upperScore = /[A-Z]/.test(password) ? 100 : 0;
            const lowerScore = /[a-z]/.test(password) ? 100 : 0;
            const numberScore = /[0-9]/.test(password) ? 100 : 0;
            const symbolScore = /[^A-Za-z0-9]/.test(password) ? 100 : 0;
            
            passwordChart.data.datasets[0].data = [lengthScore, upperScore, lowerScore, numberScore, symbolScore];
            passwordChart.update();
        }
    </script>
</body>
</html>